{
    "author":"Maroš Kollár",
    "category":"complex_applications",
    "defaults":{
        "description":"__m_descr__",
        "title":"__m_title__"
    },
    "dependencies":[
        "BaseModule"
    ],
    "homepage":"http://k-1.com",
    "icon":"icon_on.png",
    "maturity":"stable",
    "moduleName":"WindowControl",
    "options":{
        "fields":{
            "ventilationRules": {
                "dependencies" : "ventilationActive",
                "label": "__ventilation_rules_label__",
                "helper": "__ventilation_rules_helper__",
                "fields" : {
                    "windowPosition": {
                        "label" : "__window_position_label__"
                    },
                    "minTemperatureOutside":{
                        "label" : "__min_temperature_outside_label__",
                        "helper" : "__min_temperature_outside_helper__"
                    },
                    "minTime":{
                        "label" : "__min_time_label__",
                        "helper" : "__min_time_helper__"
                    },
                    "maxTime":{
                        "label" : "__min_time_label__",
                        "helper" : "__min_time_helper__"
                    },
                    "interval":{
                        "label" : "__interval_label__",
                        "helper" : "__interval_helper__"
                    },
                    "time" : {
                        "label" : "__time_label__",
                        "helper" : "__helper__",
                        "type":"array",
                        "items":{
                            "pattern" : "^([01]?[0-9]|2[0-3]):([0-5][0-9])$",
                            "placeholder" : "__time_placeholder__",
                            "type" : "string"
                        }
                    }
                }
            },
            "summerRules": {
                "dependencies" : "summerActive",
                "label": "__summer_rules_label__",
                "helper": "__summer_rules_helper__",
                "fields" : {
                    "thermostatDevice":{
                        "label":"__thermostat_device_label__",
                        "helper":"__thermostat_device_helper__",
                        "datasource":"namespaces",
                        "field" : "optionLabels",
                        "optionLabels":"namespaces:devices_thermostat:deviceName",
                        "type":"select"
                    },
                    "forecastDevice":{
                        "label":"__forecast_device_label__",
                        "helper":"__forecast_device_helper__",
                        "datasource":"namespaces",
                        "field" : "optionLabels",
                        "optionLabels":"namespaces:devices_sensorMultilevel:deviceName",
                        "type":"select"
                    },
                    "minTemperatureOutside":{
                        "label":"__min_temperature_device_label__",
                        "helper":"__min_temperature_device_helper__"
                    }
                }
            },
            "winterRules": {
                "dependencies" : "winterActive",
                "label": "__winter_rules_label__",
                "helper": "__winter_rules_helper__",
                "fields" : {
                }
            },
            "winterActive" : {
                "label": "__winter_active_label__",
                "helper": "__winter_active_helper__"
            },
            "summerActive" : {
                "label": "__summer_active_label__",
                "helper": "__summer_active_helper__"
            },
            "ventilationActive" : {
                "label": "__ventilation_active_label__",
                "helper": "__ventilation_active_helper__"
            },
            "zones":{
                "label": "__rules_label__",
                "items":{
                    "fields":{
                        "optimize": {
                            "label": "__optimize_label__",
                            "helper":"__optimize_helper__",
                            "optionLabels" : [
                                "__optimize_movement__",
                                "__optimize_temperature__"
                             ]
                        },
                        "temperatureSensors":{
                            "label":"__temperature_inside_sensor_label__",
                            "fields":{
                                "item":{
                                    "datasource":"namespaces",
                                    "field" : "optionLabels",
                                    "optionLabels":"namespaces:devices_sensorMultilevel:deviceName",
                                    "type":"select"
                                }
                            }
                        },
                        "windowDevices":{
                            "label":"__window_devices_label__",
                            "fields":{
                                "item":{
                                    "datasource":"namespaces",
                                    "field" : "optionLabels",
                                    "optionLabels":"namespaces:devices_switchMultilevel:deviceName",
                                    "type":"select"
                                }
                            }
                        },
                        "windowSensors": {
                            "type":"array",
                            "fields":{
                                "item": {
                                    "datasource":"namespaces",
                                    "field" : "optionLabels",
                                    "optionLabels":"namespaces:devices_sensorBinary:deviceName",
                                    "type":"select"
                                }
                            }
                        }
                    }
                }
            },
            "unitTemperature" : {
                "label" : "__unit_temperature__",
                "optionLabels" : [
                   "°C",
                   "°F"
                ],
                "order" : 4
            },
            "maxWind":{
                "label": "__max_wind_label__",
                "helper": "__max_wind_helper__"
            },
            "thermostatDevice":{
                "label":"__thermostat_device_label__",
                "helper":"__thermostat_device_helper__",
                "datasource":"namespaces",
                "field" : "optionLabels",
                "optionLabels":"namespaces:devices_thermostat:deviceName",
                "type":"select"
            },
            "rainSensorDevice":{
                "label":"__rain_sensor_device_label__",
                "helper":"__rain_sensor_device_helper__",
                "datasource":"namespaces",
                "field" : "optionLabels",
                "optionLabels":"namespaces:devices_sensorBinary:deviceName",
                "type":"select"
            },
            "windSensorDevice":{
                "label":"__wind_sensor_device_label__",
                "helper":"__wind_sensor_device_helper__",
                "datasource":"namespaces",
                "field" : "optionLabels",
                "optionLabels":"namespaces:devices_sensorMultilevel:deviceName",
                "type":"select"
            },
            "temperatureOutsideSensorDevice":{
                "label":"__temperature_outside_sensor_device_label__",
                "helper":"__temperature_outside_sensor_device_helper__",
                "datasource":"namespaces",
                "field" : "optionLabels",
                "optionLabels":"namespaces:devices_sensorMultilevel:deviceName",
                "type":"select"
            }
        }
    },
    "repository":{
        "source":"https://github.com/maros/Zway-WindowControl",
        "type":"git"
    },
    "schema":{
        "properties":{
            "zones": {
                "type" : "array",
                "minItem":1,
                "items":{
                    "type":"object",
                    "properties":{
                        "optimize": {
                            "enum":[
                                "movement",
                                "temperature"
                             ],
                             "default": "temperature"
                        },
                        "temperatureSensors":{
                            "type":"array",
                            "items":{
                                "datasource":"namespaces",
                                "enum":"namespaces:devices_sensorMultilevel:deviceId",
                                "field":"enum",
                                "required":true
                            },
                            "minItems":1,
                            "uniqueItems":true
                        },
                        "windowDevices":{
                            "type":"array",
                            "items":{
                                "datasource":"namespaces",
                                "enum":"namespaces:devices_switchMultilevel:deviceId",
                                "field":"enum",
                                "required":true
                            },
                            "minItems":1,
                            "uniqueItems":true
                        },
                        "windowSensors": {
                            "type":"array",
                            "items":{
                                "datasource":"namespaces",
                                "enum":"namespaces:devices_sensorBinary:deviceId",
                                "field":"enum",
                                "required":true
                            },
                            "uniqueItems":true
                        }
                    }
                }
            },
            "ventilationRules":{
                "dependencies" : "ventilationActive",
                "type": "object",
                "properties": {
                    "windowPosition": {
                        "type":"number",
                        "default":100,
                        "required":true,
                        "minimum": 10,
                        "maximum": 100
                    },
                    "minTemperatureOutside":{
                        "type":"number",
                        "default":0,
                        "required":true
                    },
                    "minTime":{
                        "minimum": 1,
                        "type":"number",
                        "default":4,
                        "required":true
                    },
                    "maxTime":{
                        "type":"number",
                        "minimum": 1,
                        "default":30,
                        "required":true
                    },
                    "interval":{
                        "type":"number",
                        "minimum": 1,
                        "default":24,
                        "required":true
                    },
                    "time" : {
                        "type":"array",
                        "items":{
                            "pattern" : "^([01]?[0-9]|2[0-3]):([0-5][0-9])$",
                            "placeholder" : "__time_placeholder__",
                            "type" : "string"
                        }
                    }
                }
            },
            "summerRules":{
                "dependencies" : "summerActive",
                "type": "object",
                "properties": {
                    "thermostatDevice":{
                        "datasource":"namespaces",
                        "enum":"namespaces:devices_thermostat:deviceId",
                        "field":"enum"
                    },
                    "forecastDevice":{
                        "datasource":"namespaces",
                        "enum":"namespaces:devices_sensorMultilevel:deviceId",
                        "field":"enum",
                        "required":true
                    },
                    "minTemperatureOutside":{
                        "type":"number",
                        "default":0,
                        "required":true
                    }
                }
            },
            "winterRules":{
                "dependencies" : "winterActive",
                "type": "object",
                "properties": {
                }
            },
            "winterActive" : {
                "default" : false,
                "type" : "boolean"
            },
            "summerActive" : {
                "default" : false,
                "type" : "boolean"
            },
            "ventilationActive" : {
                "default" : false,
                "type" : "boolean"
            },
            "unitTemperature" : {
                "enum" : [
                   "celsius",
                   "fahrenheit"
                ],
                "required" : true
            },
            "rainSensorDevice":{
                "datasource":"namespaces",
                "enum":"namespaces:devices_sensorBinary:deviceId",
                "field":"enum",
                "required":true
            },
            "maxWind":{
                "type":"number",
                "default":30,
                "required":true
            },
            "windSensorDevice":{
                "datasource":"namespaces",
                "enum":"namespaces:devices_sensorMultilevel:deviceId",
                "field":"enum",
                "required":true
            },
            "temperatureOutsideSensorDevice":{
                "datasource":"namespaces",
                "enum":"namespaces:devices_sensorMultilevel:deviceId",
                "field":"enum",
                "required":true
            }

        },
        "required":true,
        "type":"object"
    },
    "singleton":false,
    "version":"1.00"
}